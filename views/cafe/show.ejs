<!DOCTYPE html>
<html>
  <head>
      <title>Saberchat</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
      <link rel="stylesheet" href="/stylesheets/main.css">
      <!-- link css for navbar. Don't need to include public/javascript/userForm.js since user is already logged in and does not need to access login and register forms.  -->
      <link rel="stylesheet" href="/stylesheets/components/header.css">
      <link rel="stylesheet" href="/stylesheets/components/navbar.css">
      <link rel="stylesheet" href="/stylesheets/chat/new.css">

      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

      <!-- I'm using my fontawesome kit -->
      <script src="https://kit.fontawesome.com/dccc745c41.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <!-- include the navbar via ejs -->
    <%- include('../partials/navbar') %>
    <%- include('../partials/header') %>

    <div class="container mt-5">
      <div class="row">
        <div class="col-12">
          <h1 style="text-align: center; width: 100%">Edit Cafe Item<h1>
        </div>
      </div>
      <div class="row">
        <div class="col-md-8 offset-md-2 col-12">
          <form action="/cafe/item/<%= item._id %>/update?_method=put" method="post">
            <div class="form-group">
              <div class="row mb-3">
                <div class="col">
                  <label for="usernameInput">Name</label>
                  <input id="usernameInput" class="form-control" type="text" name="name" placeholder="name" value="<%= item.name %>" maxlength="45" required>
                </div>
                <div class="col">
                  <label for="priceInput">Price</label>
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <div class="input-group-text">$</div>
                    </div>
                    <input id="priceInput" class="form-control" type="text" name="price" placeholder="price" value="<%= item.price %>" maxlength="10" required>
                  </div>
                </div>
                <div class="col">
                  <label for="usernameInput">Available</label>
                  <input id="usernameInput" class="form-control" type="text" name="available" placeholder="Available Orders" value="<%= item.availableItems %>" maxlength="45" required>
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <div class="input-group mb-3" style="width: 100%;">
                    <label style="padding-top: 20px;" for="typeInput">Type</label>
                    <select id="typeInput" name="type" style="width: 100%;">
                      <option disabled selected required >Meal Type</option>
                      <% types.forEach(type => { %>
                        <% if (type.items.includes(item._id)) { %>
                            <option selected><%=type.name%></option>
                        <% } else {%>
                          <option><%=type.name%></option>
                        <% } %>
                      <% }) %>
                    </select>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col">
                  <label for="usernameInput">Image</label>
                  <input id="usernameInput" class="form-control" type="text" name="image" value="<%=item.imgUrl%>" placeholder="Enter URL for Item Image" required>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="descInput">Description</label>
              <textarea id="descInput" class="form-control" name="description" maxlength="300" rows="5" placeholder="Description" required><%= item.description %></textarea>
            </div>
            <button class="btn btn-lg btn-primary btn-block">Submit Changes</button>
          </form>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-md-8 offset-md-2 col-12">
          <form action="/cafe/item/<%= item._id %>/delete?_method=delete" method="post" id="delete-form">
            <button type="button" class="btn btn-danger btn-lg btn-block" data-toggle="modal" data-target="#modal" id="delete-button">Delete this item</button>
            <div class="modal fade" id="modal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Delete this item?</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    You will have to manually add these items back.
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Back</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                  </div>
                </div>
              </div>
            </div>
          </form>
          <a style="display: block; margin-top: 1rem; margin-bottom: 5rem;" href="/cafe/manage">Go Back</a>
        </div>
      </div>
    </div>
  </body>
</html>
