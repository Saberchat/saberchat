<!DOCTYPE html>
<html>

<head>
  <title>Saberchat</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="/stylesheets/main.css">
  <!-- link css for navbar. Don't need to include public/javascript/itemForm.js since item is already logged in and does not need to access login and register forms.  -->
  <link rel="stylesheet" href="/stylesheets/components/header.css">
  <link rel="stylesheet" href="/stylesheets/components/navbar.css">
  <link rel="stylesheet" href="/stylesheets/chat/new.css">

  <script src="/socket.io/socket.io.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

  <!-- I'm using my fontawesome kit -->
  <script src="https://kit.fontawesome.com/dccc745c41.js" crossorigin="anonymous"></script>

</head>

<body>
  <!-- include the navbar via ejs -->
  <%- include('../partials/navbar') %>
  <%- include('../partials/header') %>

  <div class="container mt-5" id="container">
    <div class="row">
      <div class="col-12">
        <div class="jumbotron text-center">
          <h1 style="text-align: center; width: 100%">New Cafe Order</h1>
          <p>Place an order that will be delivered to you at lunch</p>
          <a class="btn btn-danger" href='/cafe'><i class="fas fa-arrow-left"></i> Back to Cafe</a>
          <a class="btn btn-info" href='/cafe/menu'><i class="fas fa-bars"></i> Menu </a>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-8 offset-md-2 col-12">
        <form id="orderForm" action="/cafe/new" method="post">
          <!-- <div id="item-selection"> -->
            <!-- <h4>Select Items</h4> -->

            <!-- <div class="search-filter mb-3">
              <i class="fas fa-search"></i>
              <input id="search-input" onkeyup="searchFunction()" class="form-control" type="text" placeholder="Search..." title="Type in itemname">
            </div> -->
          <!-- </div> -->

          <div id="item-list">
            <% types.forEach(type => { %>
              <% if (type.items.length > 0) { %>
                <br />
                <li class="list-group-item list-group-item-success">
                  <div class="d-flex w-100 justify-content-between">
                    <h2 class="mb-1"><%=type.name%></h2>
                  </div>
                </li>

                <% type.items.forEach(function(item) { %>
                  <% if (item.isAvailable == true) { %>
                    <div class="list-group-item list-group-item-action form-check">

                      <!-- Div to put margins on text inside outer div -->
                      <div style="margin-left: 2%;" class="style-div">

                        <input name="check[<%= item._id %>]" id="<%= item._id%>" class="form-check-input" type="checkbox" value="">
                        <select class="num-orders" id="dd_<%=item._id%>" name="<%=item.name%>">
                          <% if (item.availableItems > 3) { %>
                            <% [1, 2, 3].forEach(function(num) { %>
                              <option><%=num%></option>
                            <% }) %>
                          <% } else { %>
                            <% let val = 0 %>
                            <% [...Array(item.availableItems).keys()].forEach(function(num) { %>
                              <% val = num + 1 %>
                              <option><%=val%></option>
                            <% }) %>
                          <% } %>
                        </select>
                        <label style="margin-left: 1%;" class="form-check-label" for="<%= item._id%>"><strong><%= item.name %></strong> (<%= item.availableItems %> orders available) - $<%= item.price %> </label>
                        <br />
                        <!-- <span class="form-check-label"><%= item.name %>: $<%= item.price %></span> -->
                      </div>
                    </div>
                  <% }%>
                <% }); %>
              <% } %>
            <% }) %>
          </div>

          <br />
          <div class="form-group mt-3">
            <textarea id="descInput" class="form-control" name="instructions" placeholder="Add special instructions for your order" maxlength="100" rows="5"></textarea>
          </div>

          <br />
          <li class="list-group-item list-group-item-primary">
            <div class="d-flex w-100 justify-content-between">
              <h2 class="mb-1">Order Summary</h2>
            </div>
          </li>

          <div>
            <div style="margin: 0px;" id="order-confirm"></div>
            <strong style="color: red; margin: 0px;" id="total-cost" class="list-group-item list-group-item-action form-check">Total: $0</strong>
          </div>

          <!-- <strong>Order: </strong> -->
          <!-- <ul id="order-confirm"></ul> -->

          <br />
          <button type="submit" class="btn btn-lg btn-primary btn-block">Complete your Order</button>
        </form>
        <br />
      </div>
    </div>
  </div>
</body>
<!--  Cafe front-end js files -->
<script src="/javascript/cafe/cafe-socket.js"></script>
<script src="/javascript/cafe/newOrder.js"></script>
</html>
