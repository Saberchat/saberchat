<!DOCTYPE html>
<html lang="en">
<head>
    <!-- home page -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saberchat</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel="stylesheet" href="/stylesheets/main.css">
    <link rel="stylesheet" href="/stylesheets/home/index.css">
    <link rel="stylesheet" href="/stylesheets/components/background.css">
    <link rel="stylesheet" href="/stylesheets/components/navbar.css">
    <link rel="stylesheet" href="/stylesheets/other/index.css">
    <%if (currentUser) {%>
      <%if (currentUser.darkmode) { %>
        <link rel="stylesheet" href="/stylesheets/darkmode.css">
      <%}%>
    <%}%>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>

    <script src="https://kit.fontawesome.com/dccc745c41.js" crossorigin="anonymous"></script>
    <script src="/javascript/nav/userForm.js"></script>
    <script src="/javascript/nav/navbar.js"></script>
    <script src="/javascript/home/index.js"></script>
    <%- include('../partials/analytics') %>
</head>
<body class="mode">

<!-- include the navbar via ejs -->
<%- include('../partials/navbar') %>
<!-- include the backdrop for nav -->
<%- include('../partials/header') %>

<!-- Background image and text -->
<section id="background" style="background-image: url('<%=platform.imageUrl%>'); background-size: cover;">
    <div class="container-fluid text-center">
        <div class="row">
            <div class="col-12 background-title">
                <h1>Saberchat</h1>
                <p><%=platform.name%>'s very own communication platform</p>
            </div>
        </div>
    </div>
</section>

<!-- Home Page content -->
<main id="main-container">
    <div class="container mt-5">
        <!-- Block -->
        <div class="row text-element">
            <div class="col-lg-6 block">
                <div class="container photo-div">
                    <% let sortedTeachers = []; %>
                    <% for (let user of teachers) { %>
                        <% if (user.permission == highestPermission) { %>
                            <% sortedTeachers.push(user); %>
                        <% } %>
                    <% } %>
                    <% for (let user of teachers) { %>
                        <% if (user.permission != highestPermission) { %>
                            <% sortedTeachers.push(user); %>
                        <% } %>
                    <% } %>
                    <% if (platform.contactPhotoDisplay && sortedTeachers.length > 0) { %>
                        <div class="row photo-row">
                            <div class="col col-photo"><img
                                        src="/images/<%= sortedTeachers[0].firstName %> <%= sortedTeachers[0].lastName %>.jpg"
                                        class="image row-end"
                                        alt="Photo of <%= sortedTeachers[0].firstName %> <%= sortedTeachers[0].lastName %>">
                            </div>
                            <% if (sortedTeachers.length > 1) { %>
                                <div class="col col-photo"><img
                                            src="/images/<%= sortedTeachers[1].firstName %> <%= sortedTeachers[1].lastName %>.jpg"
                                            class="image row-end"
                                            alt="Photo of <%= sortedTeachers[1].firstName %> <%= sortedTeachers[1].lastName %>">
                                </div>
                            <% } %>
                        </div>
                        <% counter = 0; %>
                        <% for (let i = 2; i < sortedTeachers.length; i += 3) { %>
                            <div class="row photo-row">
                                <div class="col col-photo"><img
                                            src="/images/<%= sortedTeachers[i].firstName %> <%= sortedTeachers[i].lastName %>.jpg"
                                            class="image <% if (i + 1 >= sortedTeachers.length) { %>end<% } %> <% if (i + 3 >= sortedTeachers.length) { %> row-end <% } %>"
                                            alt="Photo of <%= sortedTeachers[i].firstName %> <%= sortedTeachers[i].lastName %>">
                                </div>

                                <% if (i + 1 < sortedTeachers.length) { %>
                                    <div class="col col-photo"><img
                                                src="/images/<%= sortedTeachers[i + 1].firstName %> <%= sortedTeachers[i + 1].lastName %>.jpg"
                                                class="image <% if (i + 2 >= sortedTeachers.length) { %>end row-end<% } %>"
                                                alt="Photo of <%= sortedTeachers[i + 1].firstName %> <%= sortedTeachers[i + 1].lastName %>">
                                    </div>
                                <% } %>

                                <% if (i + 2 < sortedTeachers.length) { %>
                                    <div class="col col-photo"><img
                                                src="/images/<%= sortedTeachers[i + 2].firstName %> <%= sortedTeachers[i + 2].lastName %>.jpg"
                                                class="image <% if (i + 1 >= sortedTeachers.length) { %> row-end <% } %>"
                                                alt="Photo of <%= sortedTeachers[i + 2].firstName %> <%= sortedTeachers[i + 2].lastName %>">
                                    </div>
                                <% } %>
                            </div>
                        <div class="w-100"></div>
                        <% } %>
                    <% } %>
                </div>
            </div>

            <% if (platform.contactPhotoDisplay && sortedTeachers.length > 0) { %>
                <div class="col-lg-6 faculty-info">
            <% } else { %>
                <div class="col-lg-12 faculty-info">
            <% } %>
                    <article class="text-block">
                        <div class="block-header green">
                            <h1><%=platform.contact.heading%></h1>
                        </div>
                        <div class="block-content mode">
                            <% for (let para of platform.contact.description) { %>
                                <p class="convertible-text"><%=para%></p>
                            <% } %>
                            <% if (sortedTeachers.length > 0) { %>
                                <h5 style="padding-top: 10px;">Platform Heads</h5><hr>
                                <% sortedTeachers.forEach(user => { %>
                                    <a href="/profiles/<%=user._id%>" target="_blank" class="developer-info" style="color: black;"><%= user.firstName %> <%= user.lastName %> (<%=user.username%>)</a>
                                    <p><a href="mailto: <%= user.email %>"><%= user.email %></a></p>
                                <% }); %>
                            <% } %>
                        </div>
                    </article>
                </div>
        </div>
    </div>
</main>
<script src="/javascript/embed.js"></script>
<script>
    window.onload = (() => {
        window.onscroll = (() => {
            updateNav();
            animateDisplay();
        });
    });

</script>
</body>
</html>
